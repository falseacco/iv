<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>image viewer</title>
  </head>
  <body>
		<style>
			#title {
				z-index: -2;
				color: lightsteelblue;
			}
			#box {
				border: 1px solid lightgray;
				display: inline-block;
				padding: 20px 0px 5px 5px;
			}
			
			#display {
				/* Don't cover up anything else. */
				z-index: -1;
				/* Take up the whole page. */
				position: absolute;
				top: 0;
				left: 0;
				height: 100%;
				width: 100%;
				background-size: auto 100%;
				/* Center the background image. */
				background-position: center;
				/* Don't use the image as a tile. */
				background-repeat: no-repeat;
			}
		</style>
		<h1 id="title">iv</h1>
		
		<div id="box">
		  <input id="upload" type="file" webkitdirectory directory multiple><br>
			<a id="previous" href="#/">previous</a>
			<a id="next" href="#/">next</a>
		</div>
			
		<div id="display"></div>
			
		<script type="text/javascript">
			"use strict;"
			function print(x) {
				console.log(x);
			}
		
			function $(id) {
				return document.getElementById(id);
			}
			
			function random(min, max) { // Don't use negative numbers.
			  return Math.floor((Math.random() * max) + min);
			}
		
			function d_setVisible(id, value) {
				let x = $(id);
			
				x.style.visibility = value ? 'visible' : 'hidden';
				return x.style.visibility;
			}
			
			function d_display (img) {
				let reader = new FileReader();
				reader.readAsDataURL(img);
				reader.onload = (e)=>{
					let url = e.target.result;
					
					$('display').style.backgroundImage = 'url(' + url + ')';
				};
			}
			
			{
				let upload = [],
						currentIndex;
			
				function randomIndex() {
					return random(0, upload.length);
				}
				
				function d_displayRandom() {
					let i = randomIndex();
					d_display(upload[i]);
					currentIndex = i;
					return i;
				}
			
				// When a folder is uploaded, display something to start.
				$('upload').onchange = (e)=>{
					upload = Array.from($('upload').files);
					
					if (upload.length !== 0) {
						d_displayRandom();
					};
				}
				
				$('previous').onclick = ()=>{
					print(0);
				}
				
				$('next').onclick = ()=>{ // currentIndex should be rel. to history
					d_displayRandom();
					print(1);
				}
			}
			
			// TODO
			// previous/next[random check]
			// draggable box
			// add timer back in
		</script>
  </body>
</html>
